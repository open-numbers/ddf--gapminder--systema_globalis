info:
    id: unpop_sg_dataset
    base:
        - &d1 harpalshergill/ddf--unpop--wpp_population
        - &d2 open-numbers/ddf--gapminder--gapminder_world
        - &d3 semio/ddf--unpop--wpp_demog

config:
    recipes_dir: ./
    dictionary_dir: ../translation_dictionaries
    ddf_dir: /Users/semio/src/work/Gapminder

include:
    - recipe_gw_common.yaml
    - recipe_unpop-1.yaml
    - recipe_unpop-2.yaml
    - recipe_unpop-3.yaml
    - recipe_unpop-4.yaml
    - recipe_unpop-5.yaml

ingredients:
    - id: unpop-countries
      dataset: *d1
      key: "country"
      value: "*"

    - id: gw-concepts-unpop
      dataset: *d2
      key: concept
      value: '*'
      filter:
          concept: &CONCEPT_FILTER
              - crude_birth_rate_births_per_1000_population
              - crude_death_rate_deaths_per_1000_population
              - life_expectancy_female
              - life_expectancy_male
              - population_growth_annual_percent_with_projections
              - female_population_with_projections
              - male_population_with_projections
              - sex_ratio_0_14_years
              - sex_ratio_15_24_years
              - sex_ratio_15_49_years
              - sex_ratio_above_50_years
              - sex_ratio_all_age_groups
              - population_aged_0_4_years_both_sexes_percent
              - population_aged_0_4_years_female_percent
              - population_aged_0_4_years_male_percent
              - population_aged_0_4_years_total_number
              - population_aged_10_14_years_both_sexes_percent
              - population_aged_10_14_years_female_percent
              - population_aged_10_14_years_male_percent
              - population_aged_10_14_years_total_number
              - population_aged_15_19_years_both_sexes_percent
              - population_aged_15_19_years_female_percent
              - population_aged_15_19_years_male_percent
              - population_aged_15_19_years_total_number
              - population_aged_20_39_years_both_sexes_percent
              - population_aged_20_39_years_female_percent
              - population_aged_20_39_years_male_percent
              - population_aged_20_39_years_total_number
              - population_aged_40_59_years_both_sexes_percent
              - population_aged_40_59_years_female_percent
              - population_aged_40_59_years_male_percent
              - population_aged_40_59_years_total_number
              - population_aged_5_9_years_both_sexes_percent
              - population_aged_5_9_years_female_percent
              - population_aged_5_9_years_male_percent
              - population_aged_5_9_years_total_number
              - population_aged_60plus_years_both_sexes_percent
              - population_aged_60plus_years_female_percent
              - population_aged_60plus_years_male_percent
              - population_aged_60plus_years_total_number
              - median_age
              - children_and_elderly_per_100_adults
              - population_density_per_square_km

cooking:
    concepts:
        - procedure: merge
          ingredients:
            - gw-concepts-discrete
            - gw-concepts-geo
            - gw-concepts-unpop
          options:
              deep: true
          result: unpop-concepts-final
    datapoints:
        - procedure: merge
          ingredients:
              - unpop-datapoints-1-final
              - unpop-datapoints-2-final
              - unpop-datapoints-3-final
              - unpop-datapoints-4-final
              - unpop-datapoints-5-final
          result: unpop-datapoints-final-0
        - procedure: translate_header
          ingredients:
              - unpop-datapoints-final-0
          options:
              dictionary:
                  country: geo
                  year: time
          result: unpop-datapoints-final
